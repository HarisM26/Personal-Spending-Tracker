from datetime import date, timedelta
from django import forms
from django.test import TestCase
from django.core.files.uploadedfile import SimpleUploadedFile
from expenditure.forms import CategoryForm
from expenditure.models import Transaction, Category, Limit, User
from decimal import Decimal

class CategoryFormTestCase(TestCase):

    def setUp(self):
        self.category = Category.objects.create(
            user = User.objects.create(
                first_name = 'John',
                last_name = 'Doe',
                email = 'johndoe@email.com'
            ),
            name = "CategoryName",
            is_income = False
        )

        self.form_input = {
            'name':'Test_Category',
            'is_income':'False',
            'limit': Decimal('1000.00')
        }

    def test_form_contains_required_fields(self):
        form = CategoryForm()
        self.assertIn('name', form.fields)
        self.assertIn('is_income', form.fields)
        self.assertIn('limit', form.fields)

    def test_form_accepts_valid_input(self):
        form = CategoryForm(data=self.form_input)
        self.assertTrue(form.is_valid())

    def test_form_rejects_blank_name(self):
        self.form_input['name'] = ''
        form = CategoryForm(data=self.form_input)
        self.assertFalse(form.is_valid())

    def test_form_rejects_blank_limit(self):
        self.form_input['limit'] = ''
        form = CategoryForm(data=self.form_input)
        self.assertFalse(form.is_valid())

    '''
    def test_form_accepts_is_income(self):
        self.form_input['is_income'] = True
        form = CategoryForm(data=self.form_input)
        self.assertTrue(form.is_valid())
    '''